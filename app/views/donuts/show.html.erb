<div class="container">
  <div class=" d-flex flex-row justify-content-center row-cols-2 m-2">
      <div class="card big-white-container m-4" style="width: 18rem;">
        <div class="card-body">
            <h3><strong><%= @donut.name%></strong></h3>
          </div>
        <%= cl_image_tag(@donut.photo.key, width: 600, height: 600, crop: :fill , alt: @donut.name, class:"card-img-top rounded mx-auto d-block img-thumbnail" ) %>
        <div class="card-body">
          <h5 class="card-title"><strong>Sold by: </strong></h5>
          <p class="card-text"><%= @user.username%></p>
        </div>
        <div class="card-body">
          <h5 class="card-title"><strong>Description: </strong></h5>
          <p class="card-text"><%= @donut.description%></p>
        </div>
        <div class="card-body">
          <h5 class="card-title"><strong>Price:  </strong></h5>
          <p class="card-text">Â£<%= @donut.price%> </p>
        </div>
        <div class="card-body">
          <h5 class="card-title"><strong>Rating : </strong></h5>
          <p class="card-text"><%= image_tag "donut-c.png", width: 20, height: 20 %> <%= @donut.rating>0 ? "#{@donut.rating} (#{@donut.number_ratings})" : "N/A" %></p>
        </div>
      </div>

      <div class="d-flex flex-column m-4">
        <div id="map"
          data-controller="map"
          data-map-markers-value="<%= @markers.to_json %>"
          data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>


        <div class="card big-white-container mt-3 ml-2 p-3 shadow" style="width: 600px; height: 100%">
          <h3>Add this donut to your order</h3>
          <%= render"orders/form",donut:@donut,order:Order.new %>
        </div>
      </div>
  </div>
  <div class="row justify-content-md-center">

        <h3><strong>Reviews</strong></h3>
          <% @donut.reviews.each do |review| %>
            <div class="card big-white-container m-2 p-3 shadow" >
              <div class="card-body">
                <p class="card-text">
                  <% count = 0 %>
                  <% 5.times do %>
                    <% if review.rating > count %>
                      <%= image_tag "donut-c.png", width: 20, height: 20 %>
                    <% else %>
                      <%= image_tag "donut-bw.png", width: 20, height: 20 %>
                    <% end %>
                    <% count += 1 %>
                  <% end %>
                  <%= review.user.username %>
                </p>
              </div>
              <div class="card-body">
                <p class="card-text"><%= review.comment %></p>
              </div>
              <div class="card-body">
                <p class="card-text"><%= review.donut.user.updated_at.strftime("%a, %d %b %Y") %></p>
              </div>
            </div>
          <% end %>
      </div>
  </div>

  <button type="button" class="btn btn-dark m-3"><%= link_to "Back to Donuts", donuts_path, style: "text-decoration:none; color:white;" %></button>

</div>
