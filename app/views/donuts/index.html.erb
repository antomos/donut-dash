<div class="container">

  <div class="row justify-content-md-center">
    <% if @donuts%>
      <div class="col-10 p-3"><%= form_with url: donuts_path, method: :get, class: "d-flex" do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          placeholder: "Find a donut"
        %>
        <%= submit_tag "Search", class: "btn btn-primary" %>
      <% end %>
      </div>
      <% if !@found  %>
        <div  class="row justify-content-md-center">
          <h3>No results!</h3>
        </div>
      <% end %>
      <% if !@donuts_available.empty?%>
        <div  class="row justify-content-md-center">
          <h3>Available</h3>
        </div>
        <%  @donuts_available.each do |donut| %>
          <div class="card big-white-container col-3 m-3">
            <div class="card-body">
              <h5><strong><%= donut.name%></strong></h5>
            </div>

            <div class="d-flex justify-content-center">
                <% donut.donut_tags.each do |donut_tag| %>
                  <p class="btn m-1" style="background-color: pink;">
                    <%= "Ve" if donut_tag.tag.name == "vegan"%>
                    <%= "Vg" if donut_tag.tag.name == "vegetarian"%>
                    <%= "GF" if donut_tag.tag.name == "gluten free"%>
                    <%= "LF" if donut_tag.tag.name == "low fat"%>
                  </p>
                <% end %>
            </div>

            <%= link_to donut_path(donut) do %>
              <%= cl_image_tag(donut.photo.key, width: 600, height: 600, crop: :fill , alt: donut.name, class:"rounded mx-auto d-block img-thumbnail card-img-top" ) %>
            <% end %>
            <div class="card-body">
              <ul class="list-group list-group-flush">
                <li class="list-group-item"> <%= image_tag "donut-c.png", width: 20, height: 20 %> <%= donut.rating>0 ? "#{donut.rating} (#{donut.number_ratings})" : "N/A" %></li>
                <% price = donut.price.round(2).to_s.split(".") %>
                <% if price[1].length == 1 %>
                  <% price[1] = price[1] + "0" %>
                <%end%>
                <% price = price.join(".") %>
                <li class="list-group-item">£ <%= price%></li>
                <li class="list-group-item"><%= donut.available? ? "Available" : "Not available" %></li>
              </ul>
            </div>
          </div>
        <% end %>
      <% end %>
      <% if !@donuts_not_available.empty?%>
        <div>
          <h3>Not Available</h3>
        </div>
        <%  @donuts_not_available.each do |donut| %>
          <div class="card big-gray-container col-3 m-3">
            <div class="card-body">
              <h5><strong><%= donut.name%></strong></h5>
            </div>

            <div class="d-flex justify-content-center">
                <% donut.donut_tags.each do |donut_tag| %>
                  <p class="btn m-1" style="background-color: pink;">
                    <%= "Ve" if donut_tag.tag.name == "vegan"%>
                    <%= "Vg" if donut_tag.tag.name == "vegetarian"%>
                    <%= "GF" if donut_tag.tag.name == "gluten free"%>
                    <%= "LF" if donut_tag.tag.name == "low fat"%>
                  </p>
                <% end %>
            </div>

            <%= cl_image_tag(donut.photo.key, width: 600, height: 600, crop: :fill , alt: donut.name, class:"rounded mx-auto d-block img-thumbnail card-img-top" ) %>

            <div class="card-body">
              <ul class="list-group list-group-flush">
                <li class="list-group-item"> <%= image_tag "donut-c.png", width: 20, height: 20 %> <%= donut.rating>0 ? "#{donut.rating} (#{donut.number_ratings})" : "N/A" %></li>
                <% price = donut.price.round(2).to_s.split(".") %>
                <% if price[1].length == 1 %>
                  <% price[1] = price[1] + "0" %>
                <%end%>
                <% price = price.join(".") %>
                <li class="list-group-item">£ <%= price%></li>
                <li class="list-group-item"><%= donut.available? ? "Available" : "Not available" %></li>
              </ul>
            </div>
          </div>
        <% end %>
      <% end %>
    <% else %>
      <div  class="row justify-content-md-center">
        <h3>No donuts available! Please check later</h3>
      </div>
    <% end %>
  </div>
</div>
